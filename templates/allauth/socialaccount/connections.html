{% extends "layouts/manage.html" %}
{% load i18n %}
{% load allauth %}
{% load static %}
{% load socialaccount %}
{% load crispy_forms_tags %}

{% block head_title %}
    {% trans "Account Connections" %}
{% endblock head_title %}
{% block extra_head %}
  <style>
    .highlight-btn {
      background: #fff !important;
      color: #222 !important;
      border: none !important;
      font-weight: 600;
      transition: background 0.2s, color 0.2s, box-shadow 0.2s;
    }
    .highlight-btn:focus,
    .highlight-btn:hover {
      background: #00bfff !important;
      color: #fff !important;
    }
    .highlight-btn:focus span,
    .highlight-btn:hover span {
      color: #fff !important;
    }
  </style>
{% endblock extra_head %}

{% block hero_content %}
<div class="d-flex justify-content-center my-5">
  <div class="col-lg-8 col-md-10">
    <div class="card">
      <div class="card-body p-5">
        <h1 class="mb-4 text-center">{% trans "Account Connections" %}</h1>
        {% if form.accounts %}
          <p class="mb-3 text-light">
            {% blocktrans %}
              You can sign in to your account using any of the following third-party accounts:
            {% endblocktrans %}
          </p>
          {% url 'socialaccount_connections' as action_url %}
          <form method="post" action="{{ action_url }}">
            {% csrf_token %}
            <div class="list-group mb-3">
              {% for acc in form.fields.account.choices %}
                {% with account=acc.0.instance.get_provider_account %}
                  {% setvar radio_id %}
                    id_account_{{ account.account.pk }}
                  {% endsetvar %}
                  <div class="list-group-item bg-white">
                    <div class="form-check">
                      <input type="radio"
                             class="form-check-input"
                             id="{{ radio_id }}"
                             name="account"
                             value="{{ account.account.pk }}">
                      <label class="form-check-label text-dark" for="{{ radio_id }}">
                        {{ account }}
                        <span class="badge bg-secondary">
                          {{ account.get_brand.name }}
                        </span>
                      </label>
                    </div>
                  </div>
                {% endwith %}
              {% endfor %}
            </div>
            <div class="d-flex justify-content-end">
              <button type="submit" class="btn btn-danger">
                {% trans 'Remove' %}
              </button>
            </div>
          </form>
        {% else %}
          <p class="mb-3 text-light">
            {% trans 'You currently have no third-party accounts connected to this account.' %}
          </p>
        {% endif %}
        <hr>
        <h2 class="h4 mt-4 mb-4 text-light text-center">{% trans 'Add a Third-Party Account' %}</h2>
        <!-- Google Connect Button -->
        {% provider_login_url "google" process="connect" as google_connect_url %}
        <div class="mb-4 text-center">
          <a href="{{ google_connect_url }}" class="btn btn-light border d-inline-flex align-items-center gap-2 px-4 py-2 highlight-btn">
            <img src="{% static 'images/google-icon.png' %}" alt="Google Logo" style="width:24px; height:24px;">
            <span class="fw-semibold text-dark">{% trans "Connect with Google" %}</span>
          </a>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock hero_content %}